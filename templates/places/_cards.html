{% load static %}
{% for place in places %}
  <article class="matrix-card">
    {% with image=place.hero_image|default:'media/studio-flow.jpg' %}
      <div class="matrix-card__media">
        {% if image and '://' in image %}
          <img src="{{ image }}" alt="{{ place.name }}" loading="lazy" />
        {% else %}
          <img src="{% static image %}" alt="{{ place.name }}" loading="lazy" />
        {% endif %}
        <span class="matrix-card__badge">{{ place.facility_type }}</span>
      </div>
    {% endwith %}
    <div class="matrix-card__body">
      <div class="matrix-card__meta">
        <span>{{ place.city }}</span>
        <span>{{ place.price_display }}</span>
        <span>Rating {{ place.rating_avg|floatformat:1 }}</span>
      </div>
      <h3 class="matrix-card__title">{{ place.name }}</h3>
      <p class="text-forest-muted text-sm">{{ place.tagline|default:place.summary|truncatewords:22 }}</p>
      <div class="matrix-card__amenities">
        {% for amenity in place.amenities_list|slice:":4" %}
          <span>{{ amenity }}</span>
        {% empty %}
          <span>Premium coaching</span>
          <span>Recovery zone</span>
        {% endfor %}
      </div>
      <div class="flex flex-wrap items-center justify-between gap-3">
        <span class="matrix-price-tag">
          {{ place.price_display }}
          <span>per session</span>
        </span>
        <a href="{{ place.get_absolute_url }}" class="matrix-btn" data-variant="ghost">View space</a>
      </div>
    </div>
  </article>
{% empty %}
  <div class="matrix-empty-state">
    <h3>No spaces found</h3>
    <p>Adjust your filters or explore another facility type to widen your results.</p>
  </div>
{% endfor %}
